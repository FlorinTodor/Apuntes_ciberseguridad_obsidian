- `wp-admin`
- `wp-login.php`

Podemos ver los usuarios dentro del wordpress o con `author` :
![[../IMAGES/Pasted image 20240809151141.png]]

Tener en cuenta el fallo de wordpress para mostrar por pantalla que existe un usuario aunque no sea su contraseña:
![[../IMAGES/Pasted image 20240809151217.png]]




-wp-json/wp/v2/users -> para versiones de wordpress < 4.7.1 para ver los usuarios

## Herramientas
- uso de `searchsploit` para buscar exploit o enumeraciones.
- uso de `searchsploit -x <id-exploit>` para ver el código
- 

- uso de `whatweb <ip>` para buscar la información de una web.

- wpscan, WPSeku, Wordpressscan

### WPSCAN
![[../IMAGES/Pasted image 20240809154630.png]]![[../IMAGES/Pasted image 20240809154639.png]]![[../IMAGES/Pasted image 20240809154653.png]]


`wpscan -e` :


![[../IMAGES/Pasted image 20240809154813.png]]![[../IMAGES/Pasted image 20240809154838.png]]

USO DE TOKEN PARA BUSCAR VULNERABILIDADES:
![[../IMAGES/Pasted image 20240809160657.png]]

Buscar plugins wordpress:
![[../IMAGES/Pasted image 20240809160709.png]]

![[../IMAGES/Pasted image 20240809160859.png]]

# ARCHIVO xmlrpc.php

https://nitesculucian.github.io/2019/07/02/exploiting-the-xmlrpc-php-on-all-wordpress-versions/



file.xml:
![[../IMAGES/Pasted image 20240809161727.png]]


![[../IMAGES/Pasted image 20240809161620.png]]
![[../IMAGES/Pasted image 20240809161642.png]]


Fuerza bruta

![[../IMAGES/Pasted image 20240809162432.png]]![[../IMAGES/Pasted image 20240809162446.png]]



## Notas videos


En esta clase estaremos enseñando técnicas de enumeración para el gestor de contenido (**CMS**) **WordPress**. Un gestor de contenido es una herramienta que permite la creación, gestión y publicación de contenidos digitales en la web, como por ejemplo páginas web, blogs, tiendas en línea, entre otros.

WordPress es un CMS de código abierto muy popular que fue lanzado en 2003. Es utilizado por millones de sitios web en todo el mundo y se destaca por su facilidad de uso y flexibilidad. Con WordPress, los usuarios pueden crear y personalizar sitios web sin necesidad de conocimientos de programación avanzados. Además, cuenta con una amplia variedad de plantillas y plugins que permiten añadir funcionalidades adicionales al sitio.

El proyecto que utilizamos en esta clase para enumerar un WordPress es el siguiente:

- **DVWP**: [https://github.com/vavkamil/dvwp](https://github.com/vavkamil/dvwp)

Una de las herramientas que utilizamos en esta clase para enumerar este gestor de contenido es **Wpscan**. Wpscan es una herramienta de código abierto que se utiliza para escanear sitios web en busca de vulnerabilidades de seguridad en WordPress.

Con Wpscan, podemos realizar una enumeración completa del sitio web y obtener información detallada sobre la instalación de WordPress, como la versión utilizada, los plugins y temas instalados y los usuarios registrados en el sitio. También nos permite realizar pruebas de fuerza bruta para descubrir contraseñas débiles y vulnerabilidades conocidas en plugins y temas.

Wpscan es una herramienta muy útil para los administradores de sitios web que desean mejorar la seguridad de su sitio WordPress, ya que permite identificar y corregir vulnerabilidades antes de que sean explotadas por atacantes malintencionados. Además, es una herramienta fácil de usar y muy efectiva para identificar posibles debilidades de seguridad en nuestro sitio web.

El uso de esta herramienta es bastante sencillo, a continuación se indica la sintaxis básica:

➜ `wpscan --url https://example.com`

Si deseas enumerar usuarios o plugins vulnerables en WordPress utilizando la herramienta wpscan, puedes añadir los siguientes parámetros a la línea de comandos:

**➜** `wpscan --url https://example.com --enumerate u`

En caso de querer enumerar plugins existentes los cuales sean vulnerables, puedes añadir el siguiente parámetro a la línea de comandos:

➜ `wpscan --url https://example.com --enumerate vp`

Asimismo, otro de los recursos que contemplamos en esta clase es el archivo **xmlrpc.php**. Este archivo es una característica de WordPress que permite la comunicación entre el sitio web y aplicaciones externas utilizando el protocolo **XML-RPC**.

El archivo xmlrpc.php es utilizado por muchos plugins y aplicaciones móviles de WordPress para interactuar con el sitio web y realizar diversas tareas, como publicar contenido, actualizar el sitio y obtener información.

Sin embargo, este archivo también puede ser abusado por atacantes malintencionados para aplicar **fuerza bruta** y descubrir **credenciales válidas** de los usuarios del sitio. Esto se debe a que xmlrpc.php permite a los atacantes realizar un número ilimitado de solicitudes de inicio de sesión sin ser bloqueados, lo que hace que la ejecución de un ataque de fuerza bruta sea relativamente sencilla.

En esta clase, veremos cómo abusar del archivo **xmlrpc.php** para mediante la creación de un script de Bash aplicar fuerza bruta. El objetivo de este ejercicio será demostrar cómo los atacantes pueden utilizar este archivo existente en WordPress para intentar descubrir credenciales válidas y comprometer la seguridad del sitio web.

Para lograrlo, crearemos un script de Bash en el cual emplearemos la herramienta cURL para enviar solicitudes XML-RPC al archivo xmlrpc.php del sitio web WordPress. A través del método **wp.getUsersBlogs**, enviaremos una estructura XML que contendrá el nombre de usuario y la contraseña a probar.

En caso de que las credenciales no sean correctas, el servidor responderá con un mensaje de error que indica que las credenciales son incorrectas. Sin embargo, si las credenciales son válidas, la respuesta del servidor será diferente y no incluirá el mensaje de error.

De esta forma, podremos utilizar la respuesta del servidor para determinar cuándo hemos encontrado credenciales válidas y, de esta forma, tener acceso al sitio web de WordPress comprometido.

Cabe destacar que el método wp.getUsersBlogs **no es el único método existente**, ni mucho menos la única vulnerabilidad en xmlrpc.php. Existen otros métodos como **wp.getUsers**, **wp.getAuthors** o **wp.getComments**, entre otros, que también pueden ser utilizados por atacantes para realizar ataques de fuerza bruta y comprometer la seguridad del sitio web de WordPress.

Por lo tanto, es importante tener en cuenta que la seguridad de un sitio web de WordPress no solo depende de tener contraseñas seguras y actualizadas, sino también de estar atentos a posibles vulnerabilidades en el archivo xmlrpc.php y otras áreas del sitio web.